<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.qfedu.dao.AuthorityDao">

    <resultMap id="authorityMap" type="authority">
        <id column="id" property="id"></id>
        <result column="icon" property="icon"></result>
        <result column="aurl" property="aurl"></result>
        <result column="title" property="title"></result>
        <collection property="childs" javaType="java.util.ArrayList" ofType="authority">
            <id column="cid" property="id"></id>
            <result column="caurl" property="aurl"></result>
            <result column="ctitle" property="title"></result>
        </collection>
    </resultMap>

    <!--查询菜单子菜单-->
    <select id="findUserMenuByNo" parameterType="String" resultMap="authorityMap">
      select a.id,a.aicon icon,a.aurl,a.title,c.id cid,c.aurl caurl,c.title ctitle from t_authority a
		inner join t_authority c
		on a.id=c.parentId
		inner join t_roleauthority ra
		on a.id=ra.aid
		inner join t_role r
		on ra.rid=r.id
		inner join t_userrole ur
		on r.id=ur.rid
		inner join t_user u
		on u.id=ur.uid
		where u.no=#{no}
    </select>

</mapper>